@{
    ViewBag.Title = "Index";
}
<style>
    #TablePlanillaPendiente tbody tr td {
        white-space: normal !important;
    }
    #TablePlanillaGenerada tbody tr td {
        white-space: normal !important;
    }
    table {
        margin: 0 auto;
        width: 100%;
        clear: both;
        border-collapse: collapse;
        table-layout: fixed;
        word-wrap: break-word;
    }
</style>
<div class="row">
    <div class="col-md-12">
        <div class="card card-danger card-outline">
            <div class="card-body">
                <ul class="nav nav-tabs" id="custom-content-above-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="custom-content-above-home-tab" data-toggle="pill" href="#custom-content-above-home" role="tab" aria-controls="custom-content-above-home" aria-selected="true">Conformidades Aprobadas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="custom-content-above-constancia-tab" data-toggle="pill" href="#custom-content-above-constancia" role="tab" aria-controls="custom-content-above-constancia" aria-selected="false">Descarga Planilla Generada</a>
                    </li>
                </ul>
                <div class="tab-custom-content">
                    <p id="LblEnt" class="lead mb-0" style="font-weight:bold;color:#4a4a49"></p>
                </div>
                <div class="tab-content" id="custom-content-above-tabContent">
                    <div class="tab-pane fade show active" id="custom-content-above-home" role="tabpanel" aria-labelledby="custom-content-above-home-tab">
                        <div class="col-md-12">
                            <div class="card card-default">
                                <div class="card-header" style="background: #d2d3d5;color:#4b4b4d">
                                    <h4 class="card-title">Buscar por:</h4>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <label>Año:</label>
                                            <input type="text" id="txtAnioPago" name="txtAnioPago" class="form-control" placeholder="AÑO" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label>Mes:</label>
                                            <select name="DdlMesPago" id="DdlMesPago" class="form-control" data-width="100%">
                                                <option value="1">ENERO</option>
                                                <option value="2">FEBRERO</option>
                                                <option value="3">MARZO</option>
                                                <option value="4">ABRIL</option>
                                                <option value="5">MAYO</option>
                                                <option value="6">JUNIO</option>
                                                <option value="7">JULIO</option>
                                                <option value="8">AGOSTO</option>
                                                <option value="9">SETIEMBRE</option>
                                                <option value="10">OCTUBRE</option>
                                                <option value="11">NOVIEMBRE</option>
                                                <option value="12">DICIEMBRE</option>
                                            </select>
                                        </div>
                                        <div class="col-sm-7">
                                            <label>Entidades:</label>
                                            @Html.DropDownList("DcboEntidades", new SelectList(ViewBag.DcboEntidades, "ID_ENTIDAD", "DESC_UNIDAD"), new { @id = "DcboEntidadesPago", @class = "form-control", @name = "DcboEntidadesPago" })
                                        </div>
                                        <div class="col-sm-3">
                                            <label>&nbsp;</label>
                                            <div class="input-group">

                                                <button id="btnConsultar" type="button" class="btn btn-danger">Buscar</button>
                                                &nbsp;
                                                <button id="" type="button" class="btn btn-dark" title="Limpiar Búsqueda"> Limpiar </button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <button id="btnGeneraPlanilla" type="button"  class="btn btn-outline-danger" style="font-weight:bold">GENERAR PLANILLA <i class="fas fa-globe"></i> </button>
                        </div>
                        <div class="col-md-12">

                            <div class="table-responsive">
                                <table id="TablePlanillaPendiente" class="table table-striped table-bordered table-condensed" style="width: 100%; white-space: nowrap;">
                                    <thead>
                                        <tr>
                                            <th style="vertical-align:middle">DNI / CE</th>
                                            <th style="vertical-align:middle">APELLIDOS Y NOMBRES</th>
                                            <th style="vertical-align:middle">ENTIDAD</th>
                                            <th style="vertical-align:middle">CARGO</th>
                                            <th style="vertical-align:middle">MARCO NORMATIVO</th>
                                            <th style="vertical-align:middle">PERIODO DE PAGO</th>
                                            <th style="vertical-align:middle">N° SERIE RECIBO  </br> HONORARIOS </br> ELECTRÓNICO</th>
                                            <th style="vertical-align:middle">N° RECIBO POR </br> HONORARIOS </br> ELECTRÓNICO</th>
                                            <th style="vertical-align:middle">FECHA DE PAGO</th>
                                            <th style="vertical-align: middle">N° DE PLANILLA </br> DE LOCACIÓN </br> DE SERVICIOS</th>
                                        </tr>
                                    
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="custom-content-above-constancia" role="tabpanel" aria-labelledby="custom-content-above-constancia-tab">
                        <div class="col-md-12">
                            <div class="card card-default">
                                <div class="card-header" style="background: #d2d3d5;color:#4b4b4d">
                                    <h4 class="card-title">Buscar por:</h4>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <label>Año:</label>
                                            <input type="text" id="txtAnioPlanillaPago" name="txtAnioPlanillaPago" class="form-control" placeholder="AÑO" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label>Mes:</label>
                                            <select name="DdlMesPlanillaPago" id="DdlMesPlanillaPago" class="form-control" data-width="100%">
                                                <option value="1">ENERO</option>
                                                <option value="2">FEBRERO</option>
                                                <option value="3">MARZO</option>
                                                <option value="4">ABRIL</option>
                                                <option value="5">MAYO</option>
                                                <option value="6">JUNIO</option>
                                                <option value="7">JULIO</option>
                                                <option value="8">AGOSTO</option>
                                                <option value="9">SETIEMBRE</option>
                                                <option value="10">OCTUBRE</option>
                                                <option value="11">NOVIEMBRE</option>
                                                <option value="12">DICIEMBRE</option>
                                            </select>
                                        </div>
                                        <div class="col-sm-3">
                                            <label>N° de Planilla:</label>
                                            <input type="text" id="txtCodigoPlanillaPago" name="txtCodigoPlanillaPago" class="form-control" placeholder="CÓDIGO" />
                                        </div>
                                        <div class="col-sm-4">
                                            <label>&nbsp;</label>
                                            <div class="input-group">
                                                <button id="btnBuscaPlanilla" type="button" class="btn btn-danger" style="font-weight:bold">Buscar </button>  &nbsp;
                                                <button id="btnDescargaPlanilla" type="button" class="btn btn-dark" style="font-weight:bold">Descargar Planilla  &nbsp; <i class="fas fa-download"></i></button>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                        <div class="col-md-12">

                            <div class="table-responsive">
                                <table id="TablePlanillaGenerada" class="table table-striped table-bordered table-condensed" style="width: 100%; white-space: nowrap;">
                                    <thead>
                                        <tr>
                                            <th style="vertical-align:middle">DNI / CE</th>
                                            <th style="vertical-align:middle">APELLIDOS Y NOMBRES</th>
                                            <th style="vertical-align:middle">ENTIDAD</th>
                                            <th style="vertical-align:middle">CARGO</th>
                                            <th style="vertical-align:middle">MARCO NORMATIVO</th>
                                            <th style="vertical-align:middle">N° DE CONTRATO</th>
                                            <th style="vertical-align:middle">PERIODO DE PAGO</th>
                                            <th style="vertical-align:middle">N° SERIE RECIBO  </br> HONORARIOS </br> ELECTRÓNICO</th>
                                            <th style="vertical-align:middle">N° RECIBO POR </br> HONORARIOS </br> ELECTRÓNICO</th>
                                            <th style="vertical-align:middle">FECHA DE PAGO</th>
                                            <th style="vertical-align: middle">N° DE PLANILLA </br> DE LOCACIÓN </br> DE SERVICIOS</th>
                                        </tr>

                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

</div>
<div class="modal fade" id="modalPlanilla" role="dialog" data-backdrop="static" data-keyboard="false" style=" overflow: scroll;">
    <div class='seccionModal'>
    </div>
</div>
<script src="@Url.Content("~/Scripts/js/Remove.js")" type="text/javascript"></script>
<script src="~/Scripts/js/Administracion/Planilla.js"></script>
<script type="text/javascript">
    $(function () {
        Remove_RemoverClases("liPlanilla");
        var date = new Date();
        $("#txtAnioPago").val(date.getFullYear());
        $("#txtAnioPlanillaPago").val(date.getFullYear());
        CrearGrillaPlanillaPendiente();
        CargarGrillaPendiente();
        CrearGrillaPlanillaGenerada();
    });
    jQuery('#btnConsultar').click(function (e) {
        CargarGrillaPendiente();
    });
    jQuery("#btnGeneraPlanilla").click(function (e) {
        var table = $('#TablePlanillaPendiente').DataTable();
        var table_length = table.data().count();
        if (table_length > 0) {
            jQuery("#modalPlanilla").html('');
            jQuery("#modalPlanilla").load(baseUrl + "AltasBajas/Planilla/GenerarPlanilla" , function (responseText, textStatus, request) {
                $("#modalPlanilla").modal('show');
                $(".modal-content").draggable({
                    handle: ".modal-header", cursor: "move"
                })
            });
        } else {
            DESARROLLO.PROCESO_ALERT('Alerta', "Para generar la planilla deben existir registros en la consulta realizada.");
        }
    });
    jQuery('#btnBuscaPlanilla').click(function (e) {
        CargarGrillaGenerada();
    });
    jQuery("#btnDescargaPlanilla").click(function (e) {
        var table = $('#TablePlanillaGenerada').DataTable();
        var table_length = table.data().count();
        if (table_length > 0) {

            fn_DescargarPlanilla($("#DdlMesPlanillaPago").val(), $("#txtAnioPlanillaPago").val(), $("#txtCodigoPlanillaPago").val());
        } else {
            DESARROLLO.PROCESO_ALERT('Alerta', "Para descargar la planilla deben existir registros en la consulta realizada.");
        }
    });
</script>